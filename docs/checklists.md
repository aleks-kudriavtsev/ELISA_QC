# Чеклисты эксперимента

## Модель StepLog

StepLog фиксирует прогресс шага и хранит три ключевых блока:

- **Время**: временная метка начала и завершения шага.
- **Ввод значений**: зафиксированные измерения/параметры, введенные оператором.
- **Подтверждение**: явное подтверждение корректности ввода перед переходом дальше.

Рекомендуемый формат записи:

```
StepLog:
  stepName: "Инкубация"
  timestamp: "2024-04-27T10:35:12Z"
  status: "started"
  inputs:
    - name: "OD"
      value: 0.78
      unit: "abs"
  confirmation:
    method: "operator"
    confirmedAt: "2024-04-27T10:36:04Z"
```

При каждом обновлении статуса добавляйте запись с четким указанием шага, времени и статуса (started/finished/failed).

## UI паттерн выполнения шагов

Последовательность взаимодействия с пользователем должна быть одинаковой для каждого шага:

1. **Шаг** — отображение названия шага и краткой инструкции.
2. **Ввод** — ввод обязательных значений и параметров.
3. **Подтверждение** — пользователь подтверждает корректность введенных данных.
4. **Следующий шаг** — переход к следующей инструкции только после подтверждения.

## Правила обязательных полей

Минимальный набор обязательных полей должен быть явно указан для каждого шага. Примеры:

- **OD** (оптическая плотность): обязательна для шагов измерений.
- **Температура**: обязательна при инкубации или хранении образцов.
- **Время инкубации**: обязательное поле для выдержки.
- **ID образца**: обязательное поле для привязки результата.

Правила:

- Поля без значений блокируют подтверждение шага.
- Диапазоны значений должны проверяться (например, температура 2–8°C).
- Единицы измерения фиксируются явно.

## Фиксация отклонений от норм

Если введенное значение выходит за допустимый диапазон, это обязательно фиксируется:

- Отметить поле как **отклонение**.
- Записать причину/комментарий оператора.
- Зафиксировать статус шага как **failed** либо **finished** с пометкой отклонения.
- Сохранить запись в StepLog, включая фактическое значение и предел нормы.

Пример записи:

```
StepLog:
  stepName: "Инкубация"
  timestamp: "2024-04-27T11:05:12Z"
  status: "failed"
  inputs:
    - name: "Температура"
      value: 12
      unit: "C"
      expectedRange: "2-8"
  deviation:
    reason: "Неисправен термостат"
```
