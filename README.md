# Прототип ИФА в Telegram mini‑app

Цель проекта — создать лабораторный прототип ИФА в формате Telegram mini‑app: от планирования эксперимента до формирования итоговой сводки, с удобной фиксацией этапов и загрузкой результатов.

## Основные сценарии

1. **Планирование** — подготовка плана эксперимента, выбор протокола и параметров.
2. **Выполнение** — пошаговое прохождение чек‑листа с фиксацией статуса действий.
3. **Загрузка данных** — загрузка результатов (CSV и изображения) в связке с конкретным запуском.
4. **Сводка** — автоматическое формирование краткого отчёта по завершённым шагам и данным.

## Архитектура

- **Telegram WebApp** — интерфейс для лабораторного персонала.
- **Backend API** — логика эксперимента, валидация, управление сессиями.
- **Storage** — хранение файлов, журналирование и доступ к данным.

## Local Development

### Переменные окружения

Для запуска backend нужны переменные окружения:

- `BOT_TOKEN` — токен Telegram-бота.
- `DATABASE_URL` — строка подключения к базе данных.
- `STORAGE_PATH` — путь к директории хранения файлов.

Пример для локальной сессии:

```bash
export BOT_TOKEN=your-telegram-bot-token
export DATABASE_URL=postgres://user:password@localhost:5432/elisa
export STORAGE_PATH=./storage
```

### Backend

```bash
cd src/server
npm install
npm start
```

### Frontend

```bash
cd src/webapp
npm install
npm run dev
```

## Модули

- **Protocol Library** — библиотека протоколов ИФА с параметрами и шагами.
- **Plan Builder** — конструктор плана эксперимента и настройка условий.
- **Checklist Runner** — исполнитель чек‑листа с контролем статусов.
- **Uploads** — приём и привязка файлов к эксперименту.
- **Summary** — сборка и отображение итоговой сводки.

## Форматы данных

- **CSV** — табличные результаты и метаданные запуска.
- **Изображения** — фото планшетов, скриншоты оборудования, визуальные отметки.

## Дальнейшие шаги разработки

- **MVP** — минимальный набор функций для планирования, выполнения и загрузки данных.
- **Расширение** — аналитика, шаблоны отчётов, поддержка дополнительных протоколов.

## Фронтенд (Telegram WebApp)

Фронтенд находится в `src/webapp`.

```bash
cd src/webapp
npm install
npm run dev
```

Сборка и предпросмотр:

```bash
npm run build
npm run preview
```

## Backend API (Node.js)

Минимальный сервер находится в `src/server`.

```bash
cd src/server
npm start
```

По умолчанию сервер доступен на `http://localhost:3001` и возвращает health‑проверку на `GET /api/health`.
